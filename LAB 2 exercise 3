#include <avr/io.h>
#include <avr/interrupt.h>

void timer1_init(void) {
    // Set CTC mode (timer resets on compare match)
    TCCR1B |= (1 << WGM12);

    // Set prescaler to 1024
    TCCR1B |= (1 << CS12) | (1 << CS10);

    // Compare match value for 1 second
    OCR1A = 15624;

    // Enable compare match A interrupt
    TIMSK1 |= (1 << OCIE1A);
}

// Runs every time timer hits OCR1A (once per second)
ISR(TIMER1_COMPA_vect) {
    // Toggle LED
    PORTB ^= (1 << PORTB5);
}

int main(void) {
    // Set pin 13 (PB5) as output
    DDRB |= (1 << DDB5);

    // Start timer
    timer1_init();

    // Enable global interrupts
    sei();

    while (1) {
    }
}
